<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Russisch: Stadtplan Navigation (10 Stationen)</title>
    <style>
        :root {
            --primary-color: #3f51b5;
            --bg-color: #f4f7f6;
            --card-bg: #ffffff;
            --map-bg: #a5d6a7;
            --street-color: #ffffff;
            --text-color: #333;
            --success-color: #4CAF50;
            --error-color: #F44336;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: var(--bg-color);
            color: var(--text-color);
            margin: 0;
            padding: 20px;
            line-height: 1.5;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        h1 {
            text-align: center;
            color: #444;
            margin-bottom: 10px;
        }

        .intro {
            background-color: var(--card-bg);
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
            text-align: center;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            border-left: 5px solid var(--primary-color);
        }

        /* Layout: Map + Controls */
        .game-area {
            display: flex;
            gap: 20px;
            align-items: flex-start;
        }

        /* DIE KARTE */
        .city-map {
            flex: 2;
            background-color: var(--map-bg);
            border-radius: 12px;
            padding: 20px;
            display: grid;
            /* Flexibles Grid f√ºr viele Geb√§ude */
            grid-template-columns: repeat(auto-fill, minmax(130px, 1fr));
            gap: 15px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
            position: relative;
            min-height: 500px; /* Damit Platz zum Springen ist */
        }

        .building {
            background-color: #fff;
            border-radius: 8px;
            padding: 15px 5px;
            text-align: center;
            min-height: 90px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            border: 2px solid #81c784;
            position: relative;
            transition: transform 0.3s;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }

        .building-icon { font-size: 2rem; display: block; margin-bottom: 5px; }
        .building-name { font-weight: bold; color: #555; font-size: 0.85rem; text-transform: uppercase; }
        .building-rus { color: var(--primary-color); font-size: 1rem; font-weight: bold; }

        /* Der Spieler (Marker) */
        .player-marker {
            position: absolute;
            font-size: 3rem;
            z-index: 100;
            transition: all 0.6s cubic-bezier(0.175, 0.885, 0.32, 1.275); /* H√ºpf-Animation */
            filter: drop-shadow(0 5px 5px rgba(0,0,0,0.3));
            pointer-events: none; /* Klicks gehen durch */
        }

        /* STEUERUNG */
        .control-panel {
            flex: 1;
            background-color: var(--card-bg);
            padding: 25px;
            border-radius: 12px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
            display: flex;
            flex-direction: column;
            position: sticky;
            top: 20px;
        }

        .instruction {
            font-size: 1.2rem;
            font-weight: bold;
            color: #333;
            margin-bottom: 10px;
            border-bottom: 2px solid #eee;
            padding-bottom: 10px;
        }

        .step-counter {
            font-size: 0.9rem;
            color: #888;
            margin-bottom: 20px;
        }

        .options-grid {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .btn-option {
            padding: 15px;
            background-color: #f5f5f5;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 1.1rem;
            cursor: pointer;
            text-align: left;
            transition: all 0.2s;
            font-weight: 500;
        }

        .btn-option:hover {
            background-color: #e3f2fd;
            border-color: #90caf9;
        }

        .btn-option.correct {
            background-color: var(--success-color);
            color: white;
            border-color: var(--success-color);
        }

        .btn-option.incorrect {
            background-color: var(--error-color);
            color: white;
            border-color: var(--error-color);
        }

        .feedback-box {
            margin-top: 20px;
            font-weight: bold;
            min-height: 1.5em;
            text-align: center;
        }

        .btn-next {
            margin-top: 20px;
            padding: 12px;
            background-color: #333;
            color: white;
            border: none;
            border-radius: 25px;
            font-size: 1rem;
            cursor: pointer;
            display: none; /* Erst sichtbar wenn richtig */
        }

        /* Responsives Design */
        @media (max-width: 800px) {
            .game-area {
                flex-direction: column;
            }
            .city-map {
                width: 100%;
                box-sizing: border-box;
                grid-template-columns: repeat(auto-fill, minmax(100px, 1fr));
            }
            .control-panel {
                width: 100%;
                box-sizing: border-box;
                position: static;
            }
        }
    </style>
</head>
<body>

<div class="container">
    <h1>Stadtplan Navigation (10 Stationen)</h1>
    
    <div class="intro">
        <p>Du bist die rote Figur üßç‚Äç‚ôÇÔ∏è. <br>Finde den Weg durch die Stadt, indem du den <strong>deutschen Satz</strong> korrekt √ºbersetzt.</p>
    </div>

    <div class="game-area">
        
        <!-- Die Karte -->
        <div class="city-map" id="map-container">
            <!-- Start / Ende -->
            <div class="building" id="loc-home">
                <span class="building-icon">üè†</span>
                <span class="building-name">Haus</span>
                <span class="building-rus">–î–æ–º</span>
            </div>
            <!-- Geb√§ude 1 -->
            <div class="building" id="loc-school">
                <span class="building-icon">üè´</span>
                <span class="building-name">Schule</span>
                <span class="building-rus">–®–∫–æ–ª–∞</span>
            </div>
            <!-- Geb√§ude 2 -->
            <div class="building" id="loc-shop">
                <span class="building-icon">üõí</span>
                <span class="building-name">Laden</span>
                <span class="building-rus">–ú–∞–≥–∞–∑–∏–Ω</span>
            </div>
            <!-- Geb√§ude 3 -->
            <div class="building" id="loc-post">
                <span class="building-icon">üìÆ</span>
                <span class="building-name">Post</span>
                <span class="building-rus">–ü–æ—á—Ç–∞</span>
            </div>
            <!-- Geb√§ude 4 -->
            <div class="building" id="loc-park">
                <span class="building-icon">üå≥</span>
                <span class="building-name">Park</span>
                <span class="building-rus">–ü–∞—Ä–∫</span>
            </div>
            <!-- Geb√§ude 5 -->
            <div class="building" id="loc-stadium">
                <span class="building-icon">‚öΩ</span>
                <span class="building-name">Stadion</span>
                <span class="building-rus">–°—Ç–∞–¥–∏–æ–Ω</span>
            </div>
            <!-- Geb√§ude 6 (Neu) -->
            <div class="building" id="loc-factory">
                <span class="building-icon">üè≠</span>
                <span class="building-name">Werk</span>
                <span class="building-rus">–ó–∞–≤–æ–¥</span>
            </div>
            <!-- Geb√§ude 7 (Neu) -->
            <div class="building" id="loc-theater">
                <span class="building-icon">üé≠</span>
                <span class="building-name">Theater</span>
                <span class="building-rus">–¢–µ–∞—Ç—Ä</span>
            </div>
            <!-- Geb√§ude 8 (Neu) -->
            <div class="building" id="loc-exhibition">
                <span class="building-icon">üñºÔ∏è</span>
                <span class="building-name">Ausstellung</span>
                <span class="building-rus">–í—ã—Å—Ç–∞–≤–∫–∞</span>
            </div>
             <!-- Geb√§ude 9 (Neu) -->
             <div class="building" id="loc-station">
                <span class="building-icon">üöÜ</span>
                <span class="building-name">Bahnhof</span>
                <span class="building-rus">–í–æ–∫–∑–∞–ª</span>
            </div>

            <!-- Die Spielfigur -->
            <div class="player-marker" id="player">üßç‚Äç‚ôÇÔ∏è</div>
        </div>

        <!-- Das Bedienfeld -->
        <div class="control-panel">
            <div class="step-counter" id="step-display">Schritt 1 von 10</div>
            <div class="instruction" id="instruction-text">Lade...</div>
            
            <div class="options-grid" id="options-area">
                <!-- Buttons werden hier generiert -->
            </div>

            <div class="feedback-box" id="feedback"></div>
            <button class="btn-next" id="btn-next" onclick="nextStep()">Weiter ‚ûî</button>
            <button class="btn-next" id="btn-restart" onclick="initGame()" style="background-color: #607D8B; display:none;">Neustart ‚Ü∫</button>
        </div>

    </div>
</div>

<script>
    /*
     * SPIEL-DATEN
     * targetId: Wohin die Figur springen soll.
     */
    const steps = [
        {
            targetId: "loc-school",
            text: "1. Geh in die Schule!",
            options: [
                { text: "–Ø –∏–¥—É –≤ —à–∫–æ–ª–µ.", correct: false },
                { text: "–Ø –∏–¥—É –Ω–∞ —à–∫–æ–ª—É.", correct: false },
                { text: "–Ø –∏–¥—É –≤ —à–∫–æ–ª—É.", correct: true }
            ]
        },
        {
            targetId: "loc-shop",
            text: "2. Und jetzt geh in den Laden.",
            options: [
                { text: "–Ø –∏–¥—É –≤ –º–∞–≥–∞–∑–∏–Ω.", correct: true },
                { text: "–Ø –∏–¥—É –Ω–∞ –º–∞–≥–∞–∑–∏–Ω.", correct: false },
                { text: "–Ø –∏–¥—É –≤ –º–∞–≥–∞–∑–∏–Ω–∞.", correct: false }
            ]
        },
        {
            targetId: "loc-post",
            text: "3. Geh weiter zur Post.",
            options: [
                { text: "–ò–¥—É –≤ –ø–æ—á—Ç—É.", correct: false },
                { text: "–ò–¥—É –Ω–∞ –ø–æ—á—Ç—É.", correct: true },
                { text: "–ò–¥—É –Ω–∞ –ø–æ—á—Ç–µ.", correct: false }
            ]
        },
        {
            targetId: "loc-park",
            text: "4. Geh jetzt in den Park.",
            options: [
                { text: "–ò–¥—É –≤ –ø–∞—Ä–∫–µ.", correct: false },
                { text: "–ò–¥—É –≤ –ø–∞—Ä–∫.", correct: true },
                { text: "–ò–¥—É –Ω–∞ –ø–∞—Ä–∫.", correct: false }
            ]
        },
        {
            targetId: "loc-stadium",
            text: "5. Dann geh ins Stadion!",
            options: [
                { text: "–ù–∞ —Å—Ç–∞–¥–∏–æ–Ω!", correct: true },
                { text: "–í —Å—Ç–∞–¥–∏–æ–Ω!", correct: false },
                { text: "–ù–∞ —Å—Ç–∞–¥–∏–æ–Ω–µ!", correct: false }
            ]
        },
        // NEUE STATIONEN
        {
            targetId: "loc-factory",
            text: "6. Geh ins Werk (Fabrik).",
            options: [
                { text: "–ò–¥—É –≤ –∑–∞–≤–æ–¥.", correct: false },
                { text: "–ò–¥—É –Ω–∞ –∑–∞–≤–æ–¥.", correct: true },
                { text: "–ò–¥—É –Ω–∞ –∑–∞–≤–æ–¥–µ.", correct: false }
            ]
        },
        {
            targetId: "loc-theater",
            text: "7. Geh ins Theater.",
            options: [
                { text: "–ò–¥—É –≤ —Ç–µ–∞—Ç—Ä.", correct: true },
                { text: "–ò–¥—É –Ω–∞ —Ç–µ–∞—Ç—Ä.", correct: false },
                { text: "–ò–¥—É –≤ —Ç–µ–∞—Ç—Ä–µ.", correct: false }
            ]
        },
        {
            targetId: "loc-exhibition",
            text: "8. Geh zur Ausstellung.",
            options: [
                { text: "–ò–¥—É –≤ –≤—ã—Å—Ç–∞–≤–∫—É.", correct: false },
                { text: "–ò–¥—É –Ω–∞ –≤—ã—Å—Ç–∞–≤–∫—É.", correct: true },
                { text: "–ò–¥—É –Ω–∞ –≤—ã—Å—Ç–∞–≤–∫–∞.", correct: false }
            ]
        },
        {
            targetId: "loc-station",
            text: "9. Geh zum Bahnhof.",
            options: [
                { text: "–ò–¥—É –≤ –≤–æ–∫–∑–∞–ª.", correct: false },
                { text: "–ò–¥—É –Ω–∞ –≤–æ–∫–∑–∞–ª.", correct: true },
                { text: "–ò–¥—É –Ω–∞ –≤–æ–∫–∑–∞–ª–µ.", correct: false }
            ]
        },
        {
            targetId: "loc-home", // Zur√ºck zum Start
            text: "10. Es ist sp√§t. Geh nach Hause!",
            options: [
                { text: "–Ø –∏–¥—É –≤ –¥–æ–º.", correct: false },
                { text: "–Ø –∏–¥—É –¥–æ–º–∞.", correct: false },
                { text: "–Ø –∏–¥—É –¥–æ–º–æ–π.", correct: true }
            ]
        }
    ];

    let currentStep = 0;

    // Initialisierung beim Laden
    document.addEventListener('DOMContentLoaded', () => {
        // Kurze Verz√∂gerung, damit CSS Grid fertig gerendert ist
        setTimeout(() => {
            initGame();
        }, 100);
        
        // Browser Resize Event
        window.addEventListener('resize', () => {
             // Wenn das Spiel l√§uft, Figur neu positionieren
             const target = getCurrentLocationId();
             movePlayerTo(target);
        });
    });

    function initGame() {
        currentStep = 0;
        document.getElementById('btn-restart').style.display = 'none';
        movePlayerTo('loc-home');
        loadStep();
    }

    function getCurrentLocationId() {
        if (currentStep === 0) return 'loc-home';
        // Wenn noch nicht gel√∂st, ist die Figur beim Ziel des vorherigen Schritts
        // Wenn das Spiel vorbei ist (currentStep >= steps.length), ist sie beim letzten.
        if (currentStep >= steps.length) return steps[steps.length-1].targetId;
        
        // WICHTIG: Die Figur soll erst springen, wenn "Richtig" geklickt wurde.
        // Das bedeutet, zu Beginn von Schritt X steht sie noch bei Ziel von Schritt X-1.
        return steps[currentStep-1].targetId;
    }

    function loadStep() {
        const step = steps[currentStep];
        
        // UI Texte
        document.getElementById('step-display').textContent = `Schritt ${currentStep + 1} von ${steps.length}`;
        document.getElementById('instruction-text').textContent = step.text;
        document.getElementById('feedback').textContent = "";
        document.getElementById('btn-next').style.display = "none";

        // Optionen mischen
        const shuffledOptions = [...step.options].sort(() => Math.random() - 0.5);

        // Buttons rendern
        const optionsArea = document.getElementById('options-area');
        optionsArea.innerHTML = '';

        shuffledOptions.forEach(opt => {
            const btn = document.createElement('div');
            btn.className = 'btn-option';
            btn.textContent = opt.text;
            btn.onclick = () => checkAnswer(btn, opt.correct, step.targetId);
            optionsArea.appendChild(btn);
        });
    }

    function checkAnswer(btn, isCorrect, targetId) {
        if (document.getElementById('btn-next').style.display === 'block') return;

        const allBtns = document.querySelectorAll('.btn-option');
        allBtns.forEach(b => b.classList.remove('correct', 'incorrect'));

        const feedback = document.getElementById('feedback');

        if (isCorrect) {
            btn.classList.add('correct');
            feedback.textContent = "Richtig!";
            feedback.style.color = "var(--success-color)";
            
            // Animation
            movePlayerTo(targetId);

            if (currentStep < steps.length - 1) {
                document.getElementById('btn-next').style.display = 'block';
            } else {
                document.getElementById('btn-next').style.display = 'none';
                feedback.textContent = "Geschafft! Du bist wieder zu Hause.";
                document.getElementById('btn-restart').style.display = 'block';
            }

        } else {
            btn.classList.add('incorrect');
            feedback.textContent = "Leider falsch.";
            feedback.style.color = "var(--error-color)";
        }
    }

    function nextStep() {
        currentStep++;
        loadStep();
    }

    function movePlayerTo(elementId) {
        const targetEl = document.getElementById(elementId);
        const player = document.getElementById('player');
        const mapContainer = document.getElementById('map-container');
        
        if(!targetEl) return;

        const targetRect = targetEl.getBoundingClientRect();
        const mapRect = mapContainer.getBoundingClientRect();

        const relTop = targetRect.top - mapRect.top;
        const relLeft = targetRect.left - mapRect.left;
        
        // Zentrieren (Emoji ist ca 40-50px breit/hoch)
        const centeredLeft = relLeft + (targetRect.width / 2) - 25; 
        const centeredTop = relTop + (targetRect.height / 2) - 40; 

        player.style.left = `${centeredLeft}px`;
        player.style.top = `${centeredTop}px`;
    }
</script>

</body>
</html>